---
import BaseLayout from "../layouts/BaseLayout.astro";
import BentoGrid from "../components/BentoGrid.astro";
import BentoItem from "../components/BentoItem.astro";
import NavBar from "../components/NavBar.astro";
import Bio from "../components/Bio.astro";
import { recentMusic, recentBooks, recentHobbies } from "../data/garden";

// Logic: Latest item from each category
const latestMusic = { ...recentMusic[0], category: "Music" };
const latestBook = { ...recentBooks[0], category: "Books" };
const latestHobby = { ...recentHobbies[0], category: "Hobbies" };

// Combine and shuffle
const gardenItems = [latestMusic, latestBook, latestHobby];
const randomGardenItems = gardenItems.sort(() => Math.random() - 0.5);
---

<BaseLayout title="Guillermo Barraza">
  <NavBar />

  <main class="mt-8 mb-20">
    <Bio />

    <!-- Grid of Content -->
    <div class="w-full flex justify-center px-6">
      <BentoGrid class="w-full max-w-3xl">
        {
          randomGardenItems.map((item) => (
            <BentoItem class="group aspect-square">
              {item.category === "Music" ? (
                <div class="relative h-full w-full overflow-hidden">
                  {/* Meta Text (Revealed on hover) */}
                  <div
                    class="h-full w-full flex flex-col justify-end"
                    style="padding: 5px 0px 0px 5px;"
                  >
                    <p class="text-[10px] text-neutral-400 mb-1 font-bold uppercase tracking-[0.1em]">
                      {item.category}
                    </p>
                    <h3 class="text-base font-bold text-neutral-900 leading-tight">
                      {item.title}
                    </h3>
                    <p class="text-xs text-neutral-500 mt-1">{item.subtitle}</p>
                  </div>

                  {/* Image (Moves up on hover) - Stays absolute to cover text initially */}
                  <div class="absolute inset-0 z-10 transition-transform duration-300 ease-in-out group-hover:-translate-y-[53px]">
                    <img
                      src={
                        item.image.startsWith("/")
                          ? import.meta.env.BASE_URL + item.image
                          : item.image
                      }
                      alt={item.title}
                      class="h-full w-full object-cover rounded-lg shadow-sm"
                    />
                  </div>
                </div>
              ) : item.category === "Books" ? (
                <div class="h-full flex flex-col p-7">
                  <div class="flex justify-between items-start mb-6">
                    <p class="text-[10px] text-neutral-400 font-bold uppercase tracking-[0.1em]">
                      Books
                    </p>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2.5"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="text-neutral-300"
                    >
                      <path d="M7 17L17 7M17 7H7M17 7V17" />
                    </svg>
                  </div>

                  <div class="flex gap-6 items-center flex-1 pl-[5px]">
                    {/* Book Cover on left */}
                    <div class="w-32 aspect-[2/3] flex-shrink-0 shadow-lg rounded-sm overflow-hidden transition-transform duration-300 group-hover:scale-[1.03]">
                      <img
                        src={
                          item.image.startsWith("/")
                            ? import.meta.env.BASE_URL + item.image
                            : item.image
                        }
                        alt={item.title}
                        class="h-full w-full object-cover"
                      />
                    </div>

                    {/* Book Details on right */}
                    <div class="flex flex-col gap-1">
                      <h3 class="text-lg font-bold text-neutral-900 leading-tight">
                        {item.title}
                      </h3>
                      <p class="text-sm text-neutral-500">{item.subtitle}</p>
                    </div>
                  </div>
                </div>
              ) : (
                <div class="h-full flex flex-col justify-between p-8 text-left">
                  <div>
                    <div class="flex justify-between items-start mb-4">
                      <p class="text-[10px] text-neutral-400 font-bold uppercase tracking-[0.1em]">
                        {item.category}
                      </p>
                    </div>
                    <h3 class="text-lg font-bold text-neutral-900 leading-tight">
                      {item.title}
                    </h3>
                    <p class="text-sm text-neutral-500 mt-2 leading-relaxed">
                      {item.subtitle}
                    </p>
                  </div>
                  <a
                    href={item.link}
                    class="text-xs text-neutral-400 font-bold hover:text-neutral-900 transition-colors flex items-center gap-2 group/link"
                  >
                    VIEW DETAILS
                    <div class="p-1.5 rounded-full bg-white shadow-sm border border-neutral-100 group-hover/link:bg-neutral-50 transition-colors">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="10"
                        height="10"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="3"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path d="M7 17L17 7M17 7H7M17 7V17" />
                      </svg>
                    </div>
                  </a>
                </div>
              )}
            </BentoItem>
          ))
        }
      </BentoGrid>
    </div>
  </main>
</BaseLayout>
